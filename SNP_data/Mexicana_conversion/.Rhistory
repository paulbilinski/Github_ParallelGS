<<<<<<< HEAD
library ( emma )
library("rrBLUP")
pheno <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Master_mexnucleo_pruned.csv") #phenotype data in matching order
geno <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Mexicana_conversion/GBS_final.txt")
geno$X <- NULL
View(pheno)
plot(pheno$Altitude,pheno$X180knob.)
boxplot(pheno$Altitude,pheno$X180knob.)
plot(pheno$Altitude,pheno$X180knob.)
plot(pheno$Altitude,pheno$X180knobbp)
par(mfrow=c(1,2))
plot(pheno$Altitude,pheno$X180knobbp)
plot(pheno$Altitude,pheno$X180knobbp)
par(mfrow=c(2,1))
plot(pheno$Altitude,pheno$X180knobbp)
plot(pheno$Altitude,pheno$X180knob.)
par(mfrow=c(2,2))
plot(pheno$Altitude,pheno$X180knobbp,xlab="Altitude (m)",ylab="BP 180 knob")
plot(pheno$Altitude,pheno$X180knob.,xlab="Altitude (m)",ylab="% 180 knob")
plot(pheno$Altitude,pheno$TR1bp,xlab="Altitude (m)",ylab="BP 180 knob")
plot(pheno$Altitude,pheno$TR1.,xlab="Altitude (m)",ylab="% 180 knob")
par(mfrow=c(2,2))
plot(pheno$Altitude,pheno$X180knobbp,xlab="Altitude (m)",ylab="BP 180 knob")
plot(pheno$Altitude,pheno$X180knob.,xlab="Altitude (m)",ylab="% 180 knob")
plot(pheno$Altitude,pheno$TR1bp,xlab="Altitude (m)",ylab="BP TR1 knob")
plot(pheno$Altitude,pheno$TR1.,xlab="Altitude (m)",ylab="% TR1 knob")
setwd(~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/)
setwd("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/")
data<-read.csv("TASSEL_diversity_pipb.csv")
View(data)
data<-read.csv("TASSEL_diversity_pipb.csv",header=FALSE)
View(data)
plot(data$V2,data$V3)
plot(data$V2,data$V3,xlab="Altitude (m)",ylab="Pi per bp")
plot(data$V2,data$V3,xlab="Altitude (m)",ylab="Pi per bp",pch=19)
plot(data$V2,data$V3,xlab="Altitude (m)",ylab="Pi per bp",pch=19,main="Diversity in Mexicana Populations")
setwd("~/Desktop/teosinte_diversity/")
data<-read.csv("dothet.csv")
summary(data)
aggregate(~pop,df=data,mean)
aggregate(.~pop,df=data,mean)
?aggregate
tapply(data$F, data$pop, mean)
plot(tapply(data$F, data$pop, mean))
as.data.frame(tapply(data$F, data$pop, mean))
fval<-as.data.frame(tapply(data$F, data$pop, mean))
alt<-read.csv("tmpalts.txt")
View(alt)
alt<-read.csv("tmpalts.txt",header=FALSE)
View(fval)
cbind(alt,fval)
crap<-cbind(alt,fval)
crap<-as.data.frame(cbind(alt,fval))
crap
View(crap)
plot(crap$V2,crap$`tapply(data$F, data$pop, mean)`)
plot(crap$V2,crap$`tapply(data$F, data$pop, mean)`,ylab="Per pop mean Het")
View(data)
plot(crap$V2,crap$`tapply(data$F, data$pop, mean)`,ylab="Per pop mean F")
plot(crap$V2,crap$`tapply(data$F, data$pop, mean)`,ylab="Per pop mean F",pch=19,xlab="Altitude (m)")
setwd("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Mexicana_conversion/")
gbs<-read.table("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Mexicana_conversion/Teo_mz_joined.txt", header=TRUE) #column names still not correct
gbs<-read.table("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Mexicana_conversion/Teo_mz_joined.txt", header=TRUE) #column names still not correct
View(gbs)
row.names(gbs)<-gbs$Taxa
gbs$Taxa<- NULL
gbs2<- t(gbs)
gbs2<- gsub("G", "GG", gbs2)
gbs2<- gsub("A", "AA", gbs2)
gbs2<- gsub("C", "CC", gbs2)
gbs2<- gsub("T", "TT", gbs2)
gbs2<- gsub("Y", "CT", gbs2)
gbs2<- gsub("R", "AG", gbs2)
gbs2<- gsub("W", "AT", gbs2)
gbs2<- gsub("S", "GC", gbs2)
gbs2<- gsub("K", "TG", gbs2)
gbs2<- gsub("M", "CA", gbs2)
gbs2<- gsub("-", "NA", gbs2)
gbs2<- gsub("N", "NA", gbs2)
gbs2<- gsub("0", "NA", gbs2)
gbs2<- gsub("NAA", "NA", gbs2)
row.names(gbs2)<- NULL
write.csv(gbs2, "teomz_forSNPconversion.txt")
read.csv("Master_teomzforstruct.csv",header=FALSE)
data <- read.csv("Master_teomzforstruct.csv",header=FALSE)
View(data)
View(data)
names<-read.csv("Teomz_justorder.txt",header=FALSE)
View(data)
View(names)
View(data)
setwd("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Mexicana_conversion/")
setwd("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Mexicana_conversion/")
gbs<-read.table("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Mexicana_conversion/teomz_tassel.txt", header=TRUE) #column names still not correct
row.names(gbs)<-gbs$Taxa
gbs$Taxa<- NULL
gbs2<- t(gbs)
gbs2<- gsub("G", "GG", gbs2)
gbs2<- gsub("A", "AA", gbs2)
gbs2<- gsub("C", "CC", gbs2)
gbs2<- gsub("T", "TT", gbs2)
gbs2<- gsub("Y", "CT", gbs2)
gbs2<- gsub("R", "AG", gbs2)
gbs2<- gsub("W", "AT", gbs2)
gbs2<- gsub("K", "TG", gbs2)
gbs2<- gsub("S", "GC", gbs2)
gbs2<- gsub("M", "CA", gbs2)
gbs2<- gsub("0", "NA", gbs2)
gbs2<- gsub("-", "NA", gbs2)
gbs2<- gsub("NAA", "NA", gbs2)
gbs2<- gsub("N", "NA", gbs2)
row.names(gbs2)<- NULL
write.csv(gbs2, "teomz_forSNPconversion.txt")
data <- read.csv("teomz_clean.txt",header=FALSE)
names<-read.csv("teomz_structheader.txt",header=FALSE)
tmp<-cbind(names,data)
tmp<-rbind(names,data)
data2<-t(data)
View(data)
tmp<-rbind(names,data2)
tmp<-cbind(names,data2)
View(tmp)
write.csv(tmp,"teomz_rdyforstructure.csv")
View(tmp)
=======
plot(live$dailyavg3~live$genomesize,xlab="2C Genome Size",ylab="Daily Avg Growth (cm)",pch=18,main="3rd leaf")
abline(lm(live$dailyavg3~live$genomesize),col="red")
plot(live$dailyavg4~live$genomesize,xlab="2C Genome Size",ylab="Daily Avg Growth (cm)",pch=18,main="4th leaf")
abline(lm(live$dailyavg4~live$genomesize),col="red")
plot(live$dailyavgall~live$genomesize,xlab="2C Genome Size",ylab="Daily Avg Growth (cm)",pch=18,main="Avg 3+4 leaf")
abline(lm(live$dailyavgall~live$genomesize),col="red")
ggplot(live, aes(Pop, germinationweight)) + geom_boxplot()+ ylab("Germination Weight") + theme(legend.title=element_blank()) + xlab("Parent")
plot(live$dailyavg3~live$genomesize,xlab="2C Genome Size",ylab="Daily Avg Growth (cm)",pch=18,main="3rd leaf")
abline(lm(live$dailyavg3~live$genomesize),col="red")
live$weightdiff <- live$day4.g.-live$germinationweight
cor.test(live$weightdiff,live$genomesize)
plot(live$dailyavg3~live$genomesize,xlab="2C Genome Size",ylab="Weight Diff",pch=18,main="3rd leaf")
plot(live$dailyavg3~live$genomesize,xlab="2C Genome Size",ylab="Weight Diff",pch=18,main="Weight Diff by GS")
plot(live$weightdiff~live$genomesize,xlab="2C Genome Size",ylab="Weight Diff",pch=18,main="Weight Diff by GS")
abline(lm(live$weightdiff~live$genomesize),col="red")
plot(live$germinationweight,live$genomesize)
plot(live$germinationweight~live$genomesize)
cor.test(live$germinationweight,live$genomesize)
plot(live$dailyavg3~live$genomesize,xlab="2C Genome Size",ylab="Daily Avg Growth (cm)",pch=18,main="3rd leaf")
abline(lm(live$dailyavg3~live$genomesize),col="red")
cor.test(live$dailyavg3,live$genomesize)
cor.test(live$dailyavgall,live$genomesize)
pwr.r.test(n=202,r=-0.135101,sig.level=0.05)
library ( emma )
library("rrBLUP")
#PHENOTYPE DATA, ultimately loaded into phenoorder data frame.
lrdta <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_data.csv")
lrdta$X <- NULL
data <- subset(lrdta, lrdta$Region!="SWUS")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
#KINSHIP MATRIX, this is saved in Landrace_kinshipmatrix.csv
geno <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
#dt <-t(geno)
#A <- A.mat(dt)
#write.csv(A,"~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv")
#to make sure order is the same
A <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv",row.names="X")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
library ( emma )
library("rrBLUP")
#PHENOTYPE DATA, ultimately loaded into phenoorder data frame.
lrdta <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_data.csv")
lrdta$X <- NULL
data <- subset(lrdta, lrdta$Region!="SWUS")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
#KINSHIP MATRIX, this is saved in Landrace_kinshipmatrix.csv
geno <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
#dt <-t(geno)
#A <- A.mat(dt)
#write.csv(A,"~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv")
#to make sure order is the same
A <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv",row.names="X")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
gs <- t ( as.matrix ( phenoorder$GS_bp, ncol = 1 ) )
gsgb <- gs/1000000000
alt <- t ( as.matrix ( phenoorder$Altitude , ncol = 1 ) )
alt <- alt - mean ( alt ) + 0.5
A <- as.matrix ( A )
out.gsgb <- emma.REML.t ( gsgb , alt , K = A )
out.gsgb
?emma.REML.t
View(phenoorder)
View(data)
plot(phenoorder$X1C_GS,phenoorder$Altitude)
?abline
abline(3000,-3.77)
abline(a=3000,b=-3.77,col="red")
library ( emma )
library("rrBLUP")
#PHENOTYPE DATA, ultimately loaded into phenoorder data frame.
lrdta <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_data.csv")
lrdta$X <- NULL
data <- subset(lrdta, lrdta$Region!="SWUS")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
#KINSHIP MATRIX, this is saved in Landrace_kinshipmatrix.csv
geno <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
#dt <-t(geno)
#A <- A.mat(dt)
#write.csv(A,"~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv")
#to make sure order is the same
A <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv",row.names="X")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
library ( emma )
library("rrBLUP")
#PHENOTYPE DATA, ultimately loaded into phenoorder data frame.
lrdta <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_data.csv")
lrdta$X <- NULL
data <- subset(lrdta, lrdta$Region!="SWUS")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
#KINSHIP MATRIX, this is saved in Landrace_kinshipmatrix.csv
geno <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
#dt <-t(geno)
#A <- A.mat(dt)
#write.csv(A,"~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv")
#to make sure order is the same
A <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv",row.names="X")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
gs <- t ( as.matrix ( phenoorder$GS_bp, ncol = 1 ) )
gsgb <- gs/1000000000
alt <- t ( as.matrix ( phenoorder$Altitude , ncol = 1 ) )
alt <- alt - mean ( alt ) + 0.5
A <- as.matrix ( A )
out.gsgb <- emma.REML.t ( gsgb , alt , K = A )
out.gsgb
plot(phenoorder$X1C_GS,phenoorder$Altitude)
?emma.REML.t
plot(phenoorder$X1C_GS,phenoorder$Altitude)
emma.REML.t
out.gsgb
bob=smoothspline(phenoorder$X1C_GS,phenoorder$Altitude()
)
bob=smooth.spline(phenoorder$X1C_GS,phenoorder$Altitude)
lines(bob)
emma.REML.t
data <- read.csv("~/Documents/Projects/Genome_Size_Analysis/growthchamberplayground/pleasework.csv",header=TRUE)
library(ggplot2)
library(pwr)
live <- subset(data, data$genomesize!="NA")
View(live)
cor.test(live$dailyavg3,live$genomesize)
?cor.test
cor.test(live$dailyavg3,live$genomesize,alternative="less")
cor.test(live$dailyavgall,live$genomesize,alternative="less")
bob=live
library(tidyr)
install.packages("tidyr")
?plot.mat
?matplot
crap<-live[15,19]
crap<-live[15:18,]
View(crap)
crap<-live[,15:18]
View(crap)
matplot(crap)
matplot(t(crap))
matplot(t(crap),pch-19)
matplot(t(crap),pch=19)
matplot(t(crap),pch=19,type=c("b"))
crap2<-live[,22:25]
View(crap2)
matplot(t(crap2))
matplot(t(crap2),pch=19,type=b)
matplot(t(crap2),pch=19,type=c("b"))
matplot(t(crap2),pch=19,type="b")
View(live)
average(live$dailyavg3)
mean(live$dailyavg3)
mean(live$dailyavg4)
sd(live$dailyavg4)
sd(live$dailyavg3)
cor.test(live$dailyavg3,live$genomesize,alternative="less")
plot(live$dailyavg3~live$genomesize,xlab="2C Genome Size",ylab="Daily Avg Growth (cm)",pch=18,main="3rd leaf")
abline(lm(live$dailyavg3~live$genomesize),col="red")
cor.test(live$dailyavg3,live$genomesize,alternative="less")
plot(live$dailyavg4~live$genomesize,xlab="2C Genome Size",ylab="Daily Avg Growth (cm)",pch=18,main="4th leaf")
abline(lm(live$dailyavg4~live$genomesize),col="red")
#KINSHIP MATRIX, this is saved in Landrace_kinshipmatrix.csv
geno <- read.csv("~/Desktop/sandbox/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
#dt <-t(geno)
#A <- A.mat(dt)
#write.csv(A,"~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv")
#to make sure order is the same
A <- read.csv("~/Desktop/sandbox/Landrace_kinshipmatrix.csv",row.names="X")
#PHENOTYPE DATA, ultimately loaded into phenoorder data frame.
lrdta <- read.csv("~/Desktop/sandbox/Landrace_data.csv")
lrdta$X <- NULL
data <- subset(lrdta, lrdta$Region!="SWUS")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
#KINSHIP MATRIX, this is saved in Landrace_kinshipmatrix.csv
geno <- read.csv("~/Desktop/sandbox/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
#dt <-t(geno)
#A <- A.mat(dt)
#write.csv(A,"~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv")
#to make sure order is the same
A <- read.csv("~/Desktop/sandbox/Landrace_kinshipmatrix.csv",row.names="X")
#PHENOTYPE DATA, ultimately loaded into phenoorder data frame.
lrdta <- read.csv("~/Desktop/sandbox/Landrace_data.csv")
lrdta$X <- NULL
data <- subset(lrdta, lrdta$Region!="SWUS")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
library ( emma )
library("rrBLUP")
#PHENOTYPE DATA, ultimately loaded into phenoorder data frame.
lrdta <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_data.csv")
lrdta$X <- NULL
data <- subset(lrdta, lrdta$Region!="SWUS")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
#KINSHIP MATRIX, this is saved in Landrace_kinshipmatrix.csv
geno <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
#dt <-t(geno)
#A <- A.mat(dt)
#write.csv(A,"~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv")
#to make sure order is the same
A <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv",row.names="X")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
library ( emma )
library("rrBLUP")
#PHENOTYPE DATA, ultimately loaded into phenoorder data frame.
lrdta <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_data.csv")
lrdta$X <- NULL
data <- subset(lrdta, lrdta$Region!="SWUS")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
#KINSHIP MATRIX, this is saved in Landrace_kinshipmatrix.csv
geno <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
#dt <-t(geno)
#A <- A.mat(dt)
#write.csv(A,"~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv")
#to make sure order is the same
A <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv",row.names="X")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
gs <- t ( as.matrix ( phenoorder$GS_bp, ncol = 1 ) )
gsgb <- gs/1000000000
alt <- t ( as.matrix ( phenoorder$Altitude , ncol = 1 ) )
alt <- alt - mean ( alt ) + 0.5
A <- as.matrix ( A )
out.gsgb <- emma.REML.t ( gsgb , alt , K = A )
out.gsgb
View(gs)
plot(phenoorder$X1C_GS,phenoorder$Altitude)
plot(phenoorder$Altitude,phenoorder$X1C_GS)
plot(phenoorder$Altitude~phenoorder$X1C_GS)
plot(phenoorder$Altitude~phenoorder$X1C_GS,xlab="1C Genome Size",ylab="Altitude")
plot(phenoorder$Altitude~phenoorder$X1C_GS,xlab="1C Genome Size",ylab="Altitude",pch=19,col="blue")
data <- read.csv("~/Documents/Projects/Genome_Size_Analysis/AnnaMexpops/Annapops_MASTER.csv")
plot(data$Altitude,data$DNA.pg.2C)
boxplot(data$DNA.pg.2C~data$Altitude)
boxplot(data$DNA.pg.2C~data$Altitude)
cor.test(data$DNA.pg.2C, data$Altitude)
library(plyr)
aggdata <- ddply(data, .(Pop), numcolwise(mean))
plot(aggdata$DNA.pg.2C,aggdata$Altitude)
boxplot(data$DNA.pg.2C~data$Altitude,ylab="2C Genome Size",xlab="Altitude (m)")
ggplot(data, aes(Altitude,DNA.pg.2C))
ggplot(data, aes(Altitude,DNA.pg.2C),fill=DNA.pg.2C)
ggplot(data, aes(Altitude,DNA.pg.2C),fill=DNA.pg.2C)+geom_box()
ggplot(data, aes(Altitude,DNA.pg.2C),fill=DNA.pg.2C)+geom_boxplot()
View(data)
ggplot(data, aes(,DNA.pg.2C,Altitude))+geom_boxplot()
ggplot(data, aes(DNA.pg.2C,Altitude))+geom_boxplot()
ggplot(data, aes(Altitude))+geom_boxplot()
ggplot(data, aes(Altitude,DNA.pg.2C))+geom_boxplot()
boxplot(data$DNA.pg.2C~data$Altitude,ylab="2C Genome Size",xlab="Altitude (m)")
boxplot(data$DNA.pg.2C~data$Altitude,ylab="2C Genome Size",xlab="Altitude (m)",main="Genome size in 10 mexicana population")
data <- read.csv("~/Documents/Projects/Genome_Size_Analysis/growthchamberplayground/pleasework.csv",header=TRUE)
library(ggplot2)
library(pwr)
live <- subset(data, data$genomesize!="NA")
boxplot(live$genomesize)
View(live)
boxplot(live$genomesize~live$Pop)
boxplot(live$genomesize~live$Pop,xlab="Parent",ylab="2C Genome Size")
range(live$genomesize)
plot(live$dailyavg3~live$genomesize,xlab="2C Genome Size",ylab="Daily Avg Growth (cm)",pch=18,main="3rd leaf")
abline(lm(live$dailyavg3~live$genomesize),col="red")
cor.test(live$dailyavg3,live$genomesize,alternative="less")
cor.test(live$dailyavg4,live$genomesize,alternative="less")
cor.test(live$dailyavgall,live$genomesize,alternative="less")
plot(live$dailyavg4~live$genomesize,xlab="2C Genome Size",ylab="Daily Avg Growth (cm)",pch=18,main="4th leaf")
abline(lm(live$dailyavg4~live$genomesize),col="red")
cor.test(live$weightdiff,live$genomesize)
live$weightdiff <- live$day4.g.-live$germinationweight
cor.test(live$weightdiff,live$genomesize)
read.csv("~/Documents/Courses/NVC_Botany/Labs/Lab5_pair_t_data.csv")
data <- read.csv("~/Documents/Courses/NVC_Botany/Labs/Lab5_pair_t_data.csv")
scores <- c(0,0.626373626,0.879120879,0.868131868,0.703296703,0.813186813,0.934065934,0.912087912,0.989010989,1,0.989010989,0.791208791,0.692307692,0.857142857,0.89010989,0.747252747,0.78021978,0.934065934)
hist(scores)
scores <- c(0.626373626,0.879120879,0.868131868,0.703296703,0.813186813,0.934065934,0.912087912,0.989010989,1,0.989010989,0.791208791,0.692307692,0.857142857,0.89010989,0.747252747,0.78021978,0.934065934)
hist(scores)
plot(scores)
hist(scores)
hist(scores,breaks=4)
steph <- c(a,a,a,a,a,a,b,b,b,b,b,b,b,b,b,b,b,b,b,c,c,c,c,c,c,c,d,d,f,f,f,f,f,f)
hist(steph)
steph <- c("a","a","a","a","a","a","b","b","b","b","b","b","b","b","b","b","b","b","b","c","c","c","c","c","c","c","d","d","f","f","f","f","f","f")
hist(steph)
steph <- c(5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,2,2,1,1,1,1,1,1)
hist(steph)
hist(steph,breaks=5)
hist(steph,breaks=6)
hist(steph,breaks=5)
scores <- c(0.626373626,0.879120879,0.868131868,0.703296703,0.813186813,0.934065934,0.912087912,0.989010989,1,0.989010989,0.791208791,0.692307692,0.857142857,0.89010989,0.747252747,0.78021978,0.934065934)
hist(scores,breaks=4)
plot(scores)
hist
umm <-c(0,0.638095238,0.857142857,0.847619048,0.704761905,0.8,0.904761905,0.885714286,0.952380952,0.961904762,0.952380952,0.780952381,0.695238095,0.838095238,0.866666667,0.742857143,0.771428571,0.885714286)
hist(umm)
umm <-c(0.638095238,0.857142857,0.847619048,0.704761905,0.8,0.904761905,0.885714286,0.952380952,0.961904762,0.952380952,0.780952381,0.695238095,0.838095238,0.866666667,0.742857143,0.771428571,0.885714286)
hist(umm)
umm <-c(0.650485437,0.873786408,0.86407767,0.718446602,0.815533981,0.922330097,0.902912621,0.970873786,0.980582524,0.970873786,0.796116505,0.708737864,0.854368932,0.883495146,0.757281553,0.786407767,0.902912621)
hist(umm)
umm <-c(0.632075472,0.849056604,0.839622642,0.698113208,0.79245283,0.896226415,0.877358491,0.943396226,0.952830189,0.943396226,0.773584906,0.688679245,0.830188679,0.858490566,0.735849057,0.764150943,0.877358491)
hist(umm)
library ( emma )
library("rrBLUP")
?Amat
?A.mat
install.packages("rjags")
library ( emma )
library("rrBLUP")
geno <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
View(geno)
setwd("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Mexicana_conversion/")
hope<-read.csv("GBS_filteredfromtassel.txt",header=TRUE)
hope<-read.csv("GBS_final.txt",header=TRUE)
hope<-read.csv("GBS_final.txt",header=TRUE,row.names=FALSE)
hope<-read.table("GBS_final.txt",sep=",",header=TRUE)
hope<-read.table("FINALgbs.txt",sep=",",header=TRUE)
hope<-read.table("FINALgbs.txt",sep=",",header=TRUE,row.names=FALSE)
hope<-read.csv("FINALgbs.txt",header=TRUE,row.names=FALSE)
hope<-read.csv("FINALgbs.txt")
hope<-read.csv("FINALgbs.txt",header=TRUE)
View(hope)
?read.csv
hope<-read.csv("FINALgbs.txt",header=TRUE,row.names=FALSE)
tmp<-1:29526
hope<-read.csv("GBS_final.txt",header=TRUE,row.names(tmp))
View(hope)
hope<-read.csv("GBS_final.txt",header=TRUE,row.names(tmp),sep=",")
hope<-read.csv("GBS_final.txt",header=FALSE,sep=",")
View(hope)
hope$V94<-NULL
col.names(hope) <- hope[1,]
colnames(hope) <- hope[1,]
View(hope)
colnames(hope) <- hope[,1]
View(hope)
hope<-read.csv("GBS_final.txt",header=FALSE,sep=",")
View(hope)
hope$V94<-NULL
hope<-read.csv("GBS_final.txt",header=TRUE,sep=",")
hope<-read.csv("GBS_final.txt",header=FALSE,sep=",")
hope$V94<-NULL
hope[,1]
hope[1,]
length(hope[1,])
colnames(hope) <- hope[1,]
View(hope)
hope<-read.csv("GBS_final.txt",header=FALSE,sep=",")
hope$V94<-NULL
colnames(hope) <- hope[1,]
View(hope)
hope<-read.csv("GBS_final.txt",header=FALSE,sep=",")
View(hope)
hope$V94<-NULL
header<-c("amA","amB","amC","amD","amE","cl11","cl12","cl1","cl2","cl4","cl5","cl7","cl8","cl9","cu10","cu11","cu12","cu1","cu2","cu4","cu5","cu7","cu9","da10","da11","da1","da2","da3","da5","da8","da9","fp12","fp1","fp2","fp3","fp4","fp5","fp8","fp9","fpE","m10","m11","m2","m4","m5","m6","m7","m8","m9","mc10","mc11","mc12","mc1","mc2","mc3","mc5","mc6","mc9","mt10","mt11","mt12","mt1","mt4","mt5","mt7","mt8","mt9","tc12","tc1","tc2","tc3","tc4","tc5","tc7","tc8","tcE","tx10","tx11","tx2","tx3","tx4","tx7","tx8","tx9","tz10","tz12","tz13","tz19","tz23","tz2","tz3","tz4","tz9")
colnames(hope) <- header
View(hope)
View(geno)
View(hope)
row.names(hope) <- 1:29526
View(hope)
View(hope)
hope<-read.csv("GBS_final.txt",header=FALSE,sep=",")
hope$V94<-NULL
header<-c("amA","amB","amC","amD","amE","cl11","cl12","cl1","cl2","cl4","cl5","cl7","cl8","cl9","cu10","cu11","cu12","cu1","cu2","cu4","cu5","cu7","cu9","da10","da11","da1","da2","da3","da5","da8","da9","fp12","fp1","fp2","fp3","fp4","fp5","fp8","fp9","fpE","m10","m11","m2","m4","m5","m6","m7","m8","m9","mc10","mc11","mc12","mc1","mc2","mc3","mc5","mc6","mc9","mt10","mt11","mt12","mt1","mt4","mt5","mt7","mt8","mt9","tc12","tc1","tc2","tc3","tc4","tc5","tc7","tc8","tcE","tx10","tx11","tx2","tx3","tx4","tx7","tx8","tx9","tz10","tz12","tz13","tz19","tz23","tz2","tz3","tz4","tz9")
colnames(hope) <- header
dt<-t(hope)
A.hope <- A.mat(dt)
View(A.hope)
pheno<-read.csv("../../Mexicana/Master_mexnucleo.csv")
View(pheno)
pheno$FullID
header
crap<-pheno$FullID
remove(crap)
remove(tmp)
View(pheno)
pheno<-read.csv("../../Mexicana/Master_mexnucleo.csv")
pheno<-read.csv("../../Mexicana/Master_mexnucleo_pruned.csv")
View(pheno)
View(pheno)
gs <- t ( as.matrix ( pheno$GS_bp, ncol = 1 ) )
gsgb <- gs/1000000000
alt <- t ( as.matrix ( pheno$Altitude , ncol = 1 ) )
alt <- alt - mean ( alt ) + 0.5
A <- as.matrix ( A.hope )
out.gsgb <- emma.REML.t ( gsgb , alt , K = A )
library ( emma )
library ( emma )
?emma
library ( emma )
library ("emma")
library ("emma")
library("rrBLUP")
hope<-read.csv("GBS_final.txt",header=FALSE,sep=",")
hope$V94<-NULL
header<-c("amA","amB","amC","amD","amE","cl11","cl12","cl1","cl2","cl4","cl5","cl7","cl8","cl9","cu10","cu11","cu12","cu1","cu2","cu4","cu5","cu7","cu9","da10","da11","da1","da2","da3","da5","da8","da9","fp12","fp1","fp2","fp3","fp4","fp5","fp8","fp9","fpE","m10","m11","m2","m4","m5","m6","m7","m8","m9","mc10","mc11","mc12","mc1","mc2","mc3","mc5","mc6","mc9","mt10","mt11","mt12","mt1","mt4","mt5","mt7","mt8","mt9","tc12","tc1","tc2","tc3","tc4","tc5","tc7","tc8","tcE","tx10","tx11","tx2","tx3","tx4","tx7","tx8","tx9","tz10","tz12","tz13","tz19","tz23","tz2","tz3","tz4","tz9")
colnames(hope) <- header
dt<-t(hope)
A.hope <- A.mat(dt)
pheno<-read.csv("../../Mexicana/Master_mexnucleo_pruned.csv")
gs <- t ( as.matrix ( pheno$GS_bp, ncol = 1 ) )
gsgb <- gs/1000000000
alt <- t ( as.matrix ( pheno$Altitude , ncol = 1 ) )
alt <- alt - mean ( alt ) + 0.5
A <- as.matrix ( A.hope )
out.gsgb <- emma.REML.t ( gsgb , alt , K = A )
out.gsgb
altgroup <- t( as.matrix(pheno$Group , ncol = 1))
out.groupgsgb <- emma.REML.t ( gsgb , altgroup , K = A )
pheno<-read.csv("../../Mexicana/Master_mexnucleo_pruned.csv")
gs <- t ( as.matrix ( pheno$GS_bp, ncol = 1 ) )
gsgb <- gs/1000000000
#rescale gs so that it has less zeros
alt <- t ( as.matrix ( pheno$Altitude , ncol = 1 ) )
alt <- alt - mean ( alt ) + 0.5
A <- as.matrix ( A.hope )
out.gsgb <- emma.REML.t ( gsgb , alt , K = A )
out.gsgb
altgroup <- t( as.matrix(pheno$Group , ncol = 1))
View(pheno)
pheno<-read.csv("../../Mexicana/Master_mexnucleo_pruned.csv")
gs <- t ( as.matrix ( pheno$GS_bp, ncol = 1 ) )
gsgb <- gs/1000000000
#rescale gs so that it has less zeros
alt <- t ( as.matrix ( pheno$Altitude , ncol = 1 ) )
alt <- alt - mean ( alt ) + 0.5
A <- as.matrix ( A.hope )
out.gsgb <- emma.REML.t ( gsgb , alt , K = A )
out.gsgb
altgroup <- t( as.matrix(pheno$Group , ncol = 1))
out.groupgsgb <- emma.REML.t ( gsgb , altgroup , K = A )
out.groupgsgb
knob <- t ( as.matrix ( pheno$X180knobbp, ncol = 1 ) )
knobgb <- knob/1000000000
out.knobgb <- emma.REML.t ( knobgb , alt , K = A )
out.knobgb
tr1 <- t ( as.matrix ( phenoorder$TR1bp, ncol = 1 ) )
tr1gb <- tr1/1000000000
tr1 <- t ( as.matrix ( pheno$TR1bp, ncol = 1 ) )
tr1gb <- tr1/1000000000
out.tr1gb <- emma.REML.t ( tr1gb , alt , K = A )
out.tr1gb
View(pheno)
pheno<-read.csv("../../Mexicana/Master_mexnucleo_pruned.csv")
View(pheno)
boxplot(pheno$Altitude ~ pheno$X1C_GS)
boxplot(pheno$Altitude,pheno$X1C_GS)
boxplot(pheno$X1C_GS~pheno$Altitude)
?boxplot
plot(pheno$X1C_GS~pheno$Altitude,xlab=)
plot(pheno$X1C_GS~pheno$Altitude)
plot(pheno$X1C_GS~pheno$Altitude,pch=19)
plot(pheno$X1C_GS~pheno$Altitude,pch=10)
plot(pheno$X1C_GS~pheno$Altitude,pch=11)
plot(pheno$X1C_GS~pheno$Altitude,pch=12)
plot(pheno$X1C_GS~pheno$Altitude,pch=13)
plot(pheno$X1C_GS~pheno$Altitude,pch=4)
>>>>>>> 9418a0eb3035598edffcb06d5c38aa669b8c3859
