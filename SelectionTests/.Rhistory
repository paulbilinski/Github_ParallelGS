abline(v=0,col="red",lty=2,lwd=2)
plot(input3.8_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.6_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.4_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.2_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.0_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
par(xpd=NA)
text.x<- grconvertX(.6,from="ndc",to="user")
text.y<- grconvertY(.95,from="ndc",to="user")
text(text.x,text.y,"Stomatal Cell Size Prior Mean (cm)",cex=2.5,font=2)
text.x<- grconvertX(.05,from="ndc",to="user")
text.y<- grconvertY(.35,from="ndc",to="user")
text(text.x,text.y,"LER Prior Mean (cm)",cex=2.5,srt=90,font=2)
par(mar=c(1,.8,1,.8)+0.1,oma=c(.5,3.5,3.5,.5))
my.layout <- layout(matrix(1:14, ncol=7,byrow=TRUE),widths=c(1.5,3,3,3,3,3,3),heights=c(1,1.9))
#layout.show(my.layout)
#toprow
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"4.0",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.8",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.6",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.4",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.2",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.0",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".003",cex=2,font=2)
plot(input4.0_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.8_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.6_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.4_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.2_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.0_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
par(xpd=NA)
text.x<- grconvertX(.6,from="ndc",to="user")
text.y<- grconvertY(.95,from="ndc",to="user")
text(text.x,text.y,"LER Prior Mean (cm)",cex=1.5,font=2)
text.x<- grconvertX(.05,from="ndc",to="user")
text.y<- grconvertY(.35,from="ndc",to="user")
text(text.x,text.y,"Stomatal Cell Size Prior Mean (cm)",cex=1.5,srt=90,font=2)
par(mar=c(2,.8,2,.8)+0.1,oma=c(.5,3.5,3.5,.5))
my.layout <- layout(matrix(1:14, ncol=7,byrow=TRUE),widths=c(1.5,3,3,3,3,3,3),heights=c(1,1.9))
#layout.show(my.layout)
#toprow
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"4.0",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.8",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.6",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.4",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.2",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.0",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".003",cex=2,font=2)
plot(input4.0_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.8_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.6_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.4_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.2_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.0_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
par(xpd=NA)
text.x<- grconvertX(.6,from="ndc",to="user")
text.y<- grconvertY(.95,from="ndc",to="user")
text(text.x,text.y,"LER Prior Mean (cm)",cex=1.5,font=2)
text.x<- grconvertX(.05,from="ndc",to="user")
text.y<- grconvertY(.35,from="ndc",to="user")
text(text.x,text.y,"Stomatal Cell Size Prior Mean (cm)",cex=1.5,srt=90,font=2)
par(mar=c(2,.8,2,.8)+0.1,oma=c(.5,3.5,3.5,.5))
my.layout <- layout(matrix(1:14, ncol=7,byrow=TRUE),widths=c(1.5,3,3,3,3,3,3),heights=c(1,1.9))
#layout.show(my.layout)
#toprow
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"4.0",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.8",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.6",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.4",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.2",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.0",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".003",cex=2,font=2)
plot(input4.0_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.8_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.6_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.4_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.2_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.0_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
par(xpd=NA)
text.x<- grconvertX(.6,from="ndc",to="user")
text.y<- grconvertY(.95,from="ndc",to="user")
text(text.x,text.y,"LER Prior Mean (cm)",cex=1.5,font=2)
text.x<- grconvertX(.05,from="ndc",to="user")
text.y<- grconvertY(.35,from="ndc",to="user")
text(text.x,text.y,"Stomatal Cell Size Prior Mean (cm)",cex=1.5,srt=90,font=2)
par(mar=c(2,.8,2,.8)+0.1,oma=c(.5,3.5,3.5,.5))
my.layout <- layout(matrix(1:14, ncol=7,byrow=TRUE),widths=c(1.5,3,3,3,3,3,3),heights=c(1,1.9))
#layout.show(my.layout)
#toprow
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"4.0",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.8",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.6",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.4",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.2",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.0",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".003",cex=2,font=2,srt=90)
plot(input4.0_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.8_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.6_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.4_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.2_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.0_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
par(xpd=NA)
text.x<- grconvertX(.6,from="ndc",to="user")
text.y<- grconvertY(.95,from="ndc",to="user")
text(text.x,text.y,"LER Prior Mean (cm)",cex=1.5,font=2)
text.x<- grconvertX(.05,from="ndc",to="user")
text.y<- grconvertY(.35,from="ndc",to="user")
text(text.x,text.y,"Stomatal Cell Size Prior Mean (cm)",cex=1.5,srt=90,font=2)
library(rjags)
library(rjags)
library(stringr)
library(mcmcplots)
setwd("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/Gridcomparison/")
fgrote<-read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/grote_Indexmoms_groundedLL_d16NA.csv")
stoma.positions <- str_detect(names(fgrote),"stom*")
stoma <- fgrote[,names(fgrote)[stoma.positions]]
stoma <- 0.0001 * stoma #convert mircons to centimeters
leaflength.positions <- str_detect(names(fgrote), "leaf3diff*")#change this to leaf3diff*
leaflength <- fgrote[,names(fgrote)[leaflength.positions]]
n.cells <- apply(!is.na(stoma), MAR=1, FUN="sum")
```
DAGgamma.jags <- jags.model("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/Gridcomparison/DAG_twomediator_gamma.txt", list(leaflength=log(leaflength),stoma=log(stoma),n.mothers=max(fgrote$momindex),n.indiv=dim(fgrote)[1],n.cells=n.cells,n.times=3,mother.index=fgrote$momindex,GS=log(fgrote$genomesize)),n.chains=2)
update(DAGgamma.jags, n.iter=100000)
DAGgamma.samples <- coda.samples(DAGgamma.jags, c("beta.GS","tao.GS","GS.contrast","sd.motherStCS","sd.motherLL","sd.indivCS","sd.indivLL","sd.StCS","sd.LL","StCS.coeffs","tao.LL","LE.coeffs"),n.iter=100000, thin=800)
mcmcplot(DAGgamma.samples)
chain1<- as.matrix(DAGgamma.samples[[1]])
chain2<- as.matrix(DAGgamma.samples[[2]])
write.csv(chain1,"FINAL_4.2ll_.003cellsizechain1.csv")
write.csv(chain2,"FINAL_4.2ll_.003cellsizechain2.csv")
data<- read.csv("~/Desktop/Structure_parv_newmex/MASTER_mexparv_forstructure.txt")
data<- read.table("~/Desktop/Structure_parv_newmex/MASTER_mexparv_forstructure.txt")
View(data)
data<- read.csv("~/Desktop/Structure_parv_newmex/MASTER_mexparv_forstructure.txt")
data<- read.csv("~/Desktop/Structure_parv_newmex/MASTER_mexparv_forstructure.txt",row.names=FALSE)
data<- read.csv("~/Desktop/Structure_parv_newmex/MASTER_mexparv_forstructure.txt",row.names=NULL)
View(data)
View(data)
data<- read.csv("~/Desktop/Structure_parv_newmex/MASTER_mexparv_forstructure.txt",header=TRUE)
data<- read.csv("~/Desktop/Structure_parv_newmex/MASTER_mexparv_forstructure.txt",header=TRUE,row.names=NULL)
View(data)
data<- read.csv("~/Desktop/Structure_parv_newmex/MASTER_mexparv_forstructure2.csv")
View(data)
data<- read.csv("~/Desktop/Structure_parv_newmex/MASTER_mexparv_forstructure2.csv")
View(data)
data2 <- t(data)
View(data2)
write.csv(data2,"~/Desktop/Structure_parv_newmex/MASTER_flipped_forstructure.csv")
View(data2)
library(rjags)
library(stringr)
library(mcmcplots)
setwd("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/Gridcomparison/")
fgrote<-read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/grote_Indexmoms_groundedLL_d16NA.csv")
#make matrices with data to feed into JAGS
stoma.positions <- str_detect(names(fgrote),"stom*")
stoma <- fgrote[,names(fgrote)[stoma.positions]]
stoma <- 0.0001 * stoma #convert mircons to centimeters
leaflength.positions <- str_detect(names(fgrote), "leaf3diff*")#change this to leaf3diff*
leaflength <- fgrote[,names(fgrote)[leaflength.positions]]
n.cells <- apply(!is.na(stoma), MAR=1, FUN="sum")
DAGgamma.jags <- jags.model("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/Gridcomparison/DAG_twomediator_gamma.txt", list(leaflength=log(leaflength),stoma=log(stoma),n.mothers=max(fgrote$momindex),n.indiv=dim(fgrote)[1],n.cells=n.cells,n.times=3,mother.index=fgrote$momindex,GS=log(fgrote$genomesize)),n.chains=2)
update(DAGgamma.jags, n.iter=100000)
DAGgamma.samples <- coda.samples(DAGgamma.jags, c("beta.GS","tao.GS","GS.contrast","sd.motherStCS","sd.motherLL","sd.indivCS","sd.indivLL","sd.StCS","sd.LL","StCS.coeffs","tao.LL","LE.coeffs"),n.iter=100000, thin=800)
chain1<- as.matrix(DAGgamma.samples[[1]])
chain2<- as.matrix(DAGgamma.samples[[2]])
write.csv(chain1,"FINAL_4.4ll_.003cellsizechain1.csv")
write.csv(chain2,"FINAL_4.4ll_.003cellsizechain2.csv")
DAGgaus.jags <- jags.model("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/Gridcomparison/DAG_twomediator_gaussian.txt", list(leaflength=log(leaflength),stoma=log(stoma),n.mothers=max(fgrote$momindex),n.indiv=dim(fgrote)[1],n.cells=n.cells,n.times=3,mother.index=fgrote$momindex,GS=log(fgrote$genomesize)),n.chains=2)
update(DAGgaus.jags, n.iter=100000)
DAGgaus.samples <- coda.samples(DAGgaus.jags, c("beta.GS","tao.GS","GS.contrast","sd.motherStCS","sd.motherLL","sd.indivCS","sd.indivLL","sd.StCS","sd.LL","U.StCS.coeffs","U.tao.LL","U.LE.coeffs"),n.iter=200000, thin=1600)
DAGgamma.jags <- jags.model("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/Gridcomparison/DAG_twomediator_gamma.txt", list(leaflength=log(leaflength),stoma=log(stoma),n.mothers=max(fgrote$momindex),n.indiv=dim(fgrote)[1],n.cells=n.cells,n.times=3,mother.index=fgrote$momindex,GS=log(fgrote$genomesize)),n.chains=2)
update(DAGgamma.jags, n.iter=100000)
DAGgamma.samples <- coda.samples(DAGgamma.jags, c("beta.GS","tao.GS","GS.contrast","sd.motherStCS","sd.motherLL","sd.indivCS","sd.indivLL","sd.StCS","sd.LL","StCS.coeffs","tao.LL","LE.coeffs"),n.iter=100000, thin=800)
chain1<- as.matrix(DAGgamma.samples[[1]])
chain2<- as.matrix(DAGgamma.samples[[2]])
write.csv(chain1,"FINAL_4.6ll_.003cellsizechain1.csv")
write.csv(chain2,"FINAL_4.6ll_.003cellsizechain2.csv")
DAGgamma.jags <- jags.model("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/Gridcomparison/DAG_twomediator_gamma.txt", list(leaflength=log(leaflength),stoma=log(stoma),n.mothers=max(fgrote$momindex),n.indiv=dim(fgrote)[1],n.cells=n.cells,n.times=3,mother.index=fgrote$momindex,GS=log(fgrote$genomesize)),n.chains=2)
update(DAGgamma.jags, n.iter=100000)
DAGgamma.samples <- coda.samples(DAGgamma.jags, c("beta.GS","tao.GS","GS.contrast","sd.motherStCS","sd.motherLL","sd.indivCS","sd.indivLL","sd.StCS","sd.LL","StCS.coeffs","tao.LL","LE.coeffs"),n.iter=100000, thin=800)
chain1<- as.matrix(DAGgamma.samples[[1]])
chain2<- as.matrix(DAGgamma.samples[[2]])
write.csv(chain1,"FINAL_4.8ll_.003cellsizechain1.csv")
write.csv(chain2,"FINAL_4.8ll_.003cellsizechain2.csv")
DAGgamma.jags <- jags.model("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/Gridcomparison/DAG_twomediator_gamma.txt", list(leaflength=log(leaflength),stoma=log(stoma),n.mothers=max(fgrote$momindex),n.indiv=dim(fgrote)[1],n.cells=n.cells,n.times=3,mother.index=fgrote$momindex,GS=log(fgrote$genomesize)),n.chains=2)
update(DAGgamma.jags, n.iter=100000)
DAGgamma.samples <- coda.samples(DAGgamma.jags, c("beta.GS","tao.GS","GS.contrast","sd.motherStCS","sd.motherLL","sd.indivCS","sd.indivLL","sd.StCS","sd.LL","StCS.coeffs","tao.LL","LE.coeffs"),n.iter=100000, thin=800)
chain1<- as.matrix(DAGgamma.samples[[1]])
chain2<- as.matrix(DAGgamma.samples[[2]])
write.csv(chain1,"FINAL_4.0ll_.0032cellsizechain1.csv")
write.csv(chain2,"FINAL_4.0ll_.0032cellsizechain2.csv")
DAGgamma.jags <- jags.model("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/Gridcomparison/DAG_twomediator_gamma.txt", list(leaflength=log(leaflength),stoma=log(stoma),n.mothers=max(fgrote$momindex),n.indiv=dim(fgrote)[1],n.cells=n.cells,n.times=3,mother.index=fgrote$momindex,GS=log(fgrote$genomesize)),n.chains=2)
update(DAGgamma.jags, n.iter=100000)
DAGgamma.samples <- coda.samples(DAGgamma.jags, c("beta.GS","tao.GS","GS.contrast","sd.motherStCS","sd.motherLL","sd.indivCS","sd.indivLL","sd.StCS","sd.LL","StCS.coeffs","tao.LL","LE.coeffs"),n.iter=100000, thin=800)
chain1<- as.matrix(DAGgamma.samples[[1]])
chain2<- as.matrix(DAGgamma.samples[[2]])
write.csv(chain1,"FINAL_4.0ll_.0028cellsizechain1.csv")
write.csv(chain2,"FINAL_4.0ll_.0028cellsizechain2.csv")
DAGgamma.jags <- jags.model("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/Gridcomparison/DAG_twomediator_gamma.txt", list(leaflength=log(leaflength),stoma=log(stoma),n.mothers=max(fgrote$momindex),n.indiv=dim(fgrote)[1],n.cells=n.cells,n.times=3,mother.index=fgrote$momindex,GS=log(fgrote$genomesize)),n.chains=2)
update(DAGgamma.jags, n.iter=100000)
DAGgamma.samples <- coda.samples(DAGgamma.jags, c("beta.GS","tao.GS","GS.contrast","sd.motherStCS","sd.motherLL","sd.indivCS","sd.indivLL","sd.StCS","sd.LL","StCS.coeffs","tao.LL","LE.coeffs"),n.iter=100000, thin=800)
chain1<- as.matrix(DAGgamma.samples[[1]])
chain2<- as.matrix(DAGgamma.samples[[2]])
write.csv(chain1,"FINAL_3.60ll_.0028cellsizechain1.csv")
write.csv(chain2,"FINAL_3.6ll_.0028cellsizechain2.csv")
write.csv(chain1,"FINAL_3.6ll_.0028cellsizechain1.csv")
DAGgamma.jags <- jags.model("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/Gridcomparison/DAG_twomediator_gamma.txt", list(leaflength=log(leaflength),stoma=log(stoma),n.mothers=max(fgrote$momindex),n.indiv=dim(fgrote)[1],n.cells=n.cells,n.times=3,mother.index=fgrote$momindex,GS=log(fgrote$genomesize)),n.chains=2)
update(DAGgamma.jags, n.iter=100000)
DAGgamma.samples <- coda.samples(DAGgamma.jags, c("beta.GS","tao.GS","GS.contrast","sd.motherStCS","sd.motherLL","sd.indivCS","sd.indivLL","sd.StCS","sd.LL","StCS.coeffs","tao.LL","LE.coeffs"),n.iter=100000, thin=800)
chain1<- as.matrix(DAGgamma.samples[[1]])
chain2<- as.matrix(DAGgamma.samples[[2]])
write.csv(chain1,"FINAL_3.6ll_.0032cellsizechain1.csv")
write.csv(chain2,"FINAL_3.6ll_.0032cellsizechain2.csv")
setwd("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/Mexicana/Grote_stats/Gridcomparison/")
chain1<- read.csv("FINAL_4.0ll_.003cellsizechain1.csv")
chain2<- read.csv("FINAL_4.0ll_.003cellsizechain2.csv")
both<- rbind(chain1,chain2)
input4.0_.3 <- density(both$GS.contrast,adjust=1.3,from=-.1,to=.1)
chain1<- read.csv("FINAL_4.0ll_.0032cellsizechain1.csv")
chain2<- read.csv("FINAL_4.0ll_.0032cellsizechain2.csv")
both<- rbind(chain1,chain2)
input4.0_.32 <- density(both$GS.contrast,adjust=1.3,from=-.1,to=.1)
chain1<- read.csv("FINAL_4.0ll_.0028cellsizechain1.csv")
chain2<- read.csv("FINAL_4.0ll_.0028cellsizechain2.csv")
both<- rbind(chain1,chain2)
input4.0_.28 <- density(both$GS.contrast,adjust=1.3,from=-.1,to=.1)
chain1<- read.csv("FINAL_3.6ll_.003cellsizechain1.csv")
chain2<- read.csv("FINAL_3.6ll_.003cellsizechain2.csv")
both<- rbind(chain1,chain2)
input3.6_.3 <- density(both$GS.contrast,adjust=1.3,from=-.1,to=.1)
chain1<- read.csv("FINAL_3.6ll_.003cellsizechain1.csv")
chain2<- read.csv("FINAL_3.6ll_.003cellsizechain2.csv")
both<- rbind(chain1,chain2)
input3.6_.3 <- density(both$GS.contrast,adjust=1.3,from=-.1,to=.1)
chain1<- read.csv("FINAL_3.6ll_.0028cellsizechain1.csv")
chain2<- read.csv("FINAL_3.6ll_.0028cellsizechain2.csv")
both<- rbind(chain1,chain2)
input3.6_.28 <- density(both$GS.contrast,adjust=1.3,from=-.1,to=.1)
chain1<- read.csv("FINAL_3.6ll_.0032cellsizechain1.csv")
chain2<- read.csv("FINAL_3.6ll_.0032cellsizechain2.csv")
both<- rbind(chain1,chain2)
input3.6_.32 <- density(both$GS.contrast,adjust=1.3,from=-.1,to=.1)
par(mar=c(2,.8,2,.8)+0.1,oma=c(.5,3.5,3.5,.5))
my.layout <- layout(matrix(1:12, ncol=4,byrow=TRUE),widths=c(1.5,3,3,3),heights=c(1,1,1))
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".0028",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".0030",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".0032",cex=2,font=2)
par(mar=c(2,.8,2,.8)+0.1,oma=c(.5,3.5,3.5,.5))
my.layout <- layout(matrix(1:12, ncol=4,byrow=TRUE),widths=c(1.5,3,3,3),heights=c(1,1,1))
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".0028",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".0030",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".0032",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.6",cex=2,font=2)
plot(input3.6_.28,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.6_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.6_.32,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"4.0",cex=2,font=2)
plot(input4.0_.28,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input4.0_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input4.0_.32,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
par(xpd=NA)
text.x<- grconvertX(.6,from="ndc",to="user")
text.y<- grconvertY(.95,from="ndc",to="user")
text(text.x,text.y,"LER Prior Mean (cm)",cex=1.5,font=2)
text(text.x,text.y,"LER Prior Mean (cm)",cex=1.5,srt=90,font=2)
par(mar=c(2,.8,2,.8)+0.1,oma=c(.5,3.5,3.5,.5))
my.layout <- layout(matrix(1:12, ncol=4,byrow=TRUE),widths=c(1.5,3,3,3),heights=c(1,1,1))
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".0028",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".0030",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,".0032",cex=2,font=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"3.6",cex=2,font=2)
plot(input3.6_.28,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.6_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input3.6_.32,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(c(0,1),c(0,1),type="n",bty="n",xaxt="n",yaxt="n",xlab="",ylab="")
text(0.5,0.5,"4.0",cex=2,font=2)
plot(input4.0_.28,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input4.0_.3,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
plot(input4.0_.32,ylab="",yaxt="n",main="",bty="n",lwd=2,cex.axis=1.5)
abline(v=0,col="red",lty=2,lwd=2)
par(xpd=NA)
text.x<- grconvertX(.6,from="ndc",to="user")
text.y<- grconvertY(.95,from="ndc",to="user")
text(text.x,text.y,"Stomatal Cell Size Prior Mean (cm)",cex=1.5,font=2)
text.x<- grconvertX(.05,from="ndc",to="user")
text.y<- grconvertY(.35,from="ndc",to="user")
text(text.x,text.y,"LER Prior Mean (cm)",cex=1.5,srt=90,font=2)
data<- read.csv("~/Desktop/Structure_parv_newmex/Converted_justgenos.csv")
data2 <- t(data)
write.csv(data2,"~/Desktop/Structure_parv_newmex/Master_forstructure.csv")
View(data2)
View(data)
data<- read.csv("~/Desktop/Structure_parv_newmex/Converted_justgenos.csv")
View(data)
data2 <- t(data)
write.csv(data2,"~/Desktop/Structure_parv_newmex/Master_forstructure.csv")
data<- read.csv("~/Desktop/Structure_parv_newmex/JustGenos_mexparv.txt")
data2 <- t(data)
write.csv(data2,"~/Desktop/Structure_parv_newmex/Flipped_Justgenos_mexparv.csv")
data<- read.csv("~/Desktop/Structure_parv_newmex/JustGenos_mexparv.txt")
View(data)
data<- read.csv("~/Desktop/Structure_parv_newmex/JustGenos_mexparv.txt",header=FALSE)
data2 <- t(data)
View(data2)
write.csv(data2,"~/Desktop/Structure_parv_newmex/Flipped_Justgenos_mexparv.csv")
data <- read.csv("~/Desktop/Structure_parv_newmex/Structureoutput.txt")
View(data)
data <- read.csv("~/Desktop/Structure_parv_newmex/Structureoutput.txt",header=FALSE)
View(data)
plot(data$V2)
View(data)
barplot(data$V2)
View(data)
View(data)
library(ggplot2)
library(dplyr)
data2 <- mutate(data,pop=substr(V1,1,2))
View(data2)
data2 <- mutate(data,pop=ifelse(substr(V1,1,4)=="RIMPA",susbstr(V1,5,3),substr(V1,1,2))
)
view(data2)
View(data2)
substr(data$V1,1,4)
data2 <- mutate(data,pop=ifelse(substr(V1,1,5)=="RIMPA",susbstr(V1,6,3),substr(V1,1,2)))
data2 <- mutate(data,pop=ifelse(substr(V1,1,5)=="RIMPA",substr(V1,6,3),substr(V1,1,2)))
tail(data2)
data2 <- mutate(data,pop=ifelse(substr(V1,1,5)=="RIMPA",substr(V1,6,9),substr(V1,1,2)))
tail(data2)
data2 <- mutate(data,pop=ifelse(substr(V1,1,5)=="RIMPA",substr(V1,6,10),substr(V1,1,2)))
tail(data2)
data2 <- mutate(data,pop=ifelse(substr(V1,1,5)=="RIMPA",substr(V1,6,9),substr(V1,1,2)))
tail(data2)
ggplot(data2) %>% geom_bar(V1,aes(fill=pop))
ggplot(data2) + geom_bar(V1,aes(fill=pop))
ggplot(data2,aes(V2)) + geom_bar(aes(fill=pop))
?geom_bar
ggplot(data2,aes(V2)) + geom_bar(aes(fill=pop,position="dodge"))
ggplot(data2,aes(V2)) + geom_bar(aes(stat="identity",fill=pop,position="dodge"))
ggplot(data2,aes(V2)) + geom_bar(stat="identity",aes(fill=pop,position="dodge"))
ggplot(data2,aes(V2,color=pop))
ggplot(data2,aes(V2,V1,color=pop))
ggplot(data2,aes(V2)) + geom_bar(stat="identity",aes(fill=pop,position="dodge"))
?geom_bar
ggplot(data2,aes(V2)) + geom_bar(aes(fill=pop),position="dodge"))
ggplot(data2,aes(V2)) + geom_bar(aes(fill=pop),position="dodge")
?geom_bar
ggplot(data2,aes(V2)) + geom_bar(aes(fill=pop),position="dodge",stat="identity")
?geom_bar
ggplot(data2,aes(V2,fill=pop)) + geom_bar(position="dodge",stat="identity")
ggplot(data2,aes(V1,V2,fill=pop)) + geom_bar(position="dodge",stat="identity")
ggplot(data2,aes(V1,V2,fill=pop)) + geom_bar(position="dodge",stat="identity")+ opts(axis.text.x=theme_text(angle=-90))
ggplot(data2,aes(V1,V2,fill=pop)) + geom_bar(position="dodge",stat="identity")+ theme(axis.text.x=theme_text(angle=-90))
ggplot(data2,aes(V1,V2,fill=pop)) + geom_bar(position="dodge",stat="identity")+theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
setwd("~/Documents/Projects/Genome_Size_Analysis")
library(ggplot2) #something stupid ggplot2 crashing rstudio
library(gridExtra)
dataall <- read.csv("Master_Data_noNA.csv")
dataal <- subset(dataall, dataall$X1C_GS!="NA")
data <- subset(dataal, dataal$X1C_GS<3.6)
dmays <- subset(data, data$Species=="mays")
dmayst <- subset(dmays, dmays$Region!="SWUS")
dmex <- subset(data, data$Species=="mexicana")
dparv <- subset(data, data$Species=="parviglumis")
dteo <- rbind(dparv,dmex)
setwd("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SelectionTests/")
library("rrBLUP")
geno <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
dt <-t(geno)
A <- A.mat(dt)
pheno <-read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Landraces_noSWUS_pheno.csv",header=TRUE)
tmp1 <- as.data.frame(colnames(geno))
names(tmp1)[1] <- "names"
tmp2 <- as.data.frame(pheno$FullID)
tmp <- setdiff(tmp1,tmp2)
phenoorder <- merge(tmp1,pheno, by.x="names", by.y="FullID",sort=FALSE)
pheno <-read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Landraces_noSWUS_pheno.csv",header=TRUE)
#to make sure order is the same
tmp1 <- as.data.frame(colnames(geno))
names(tmp1)[1] <- "names"
tmp2 <- as.data.frame(pheno$FullID)
tmp <- setdiff(tmp1,tmp2)
phenoorder <- merge(tmp1,pheno, by.x="names", by.y="FullID",sort=FALSE)
View(phenoorder)
library ( emma )
library("rrBLUP")
lrdta <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_data.csv")
lrdta$X <- NULL
data <- subset(lrdta, lrdta$Region!="SWUS")
geno <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
A <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv",row.names="X")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
#again, this is where i realize i had to rename 626.2 to 626.1
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
geno <- read.csv("~/Desktop/sandbox/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
geno <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SNP_data/Landrace_noSWUS_matrix.csv",header=TRUE,row.names=1)
A <- read.csv("~/Desktop/sandbox/Landrace_kinshipmatrix.csv",row.names="X")
A <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_kinshipmatrix.csv",row.names="X")
lrdta <- read.csv("~/Desktop/sandbox/Landrace_data.csv")
lrdta$X <- NULL
lrdta <- read.csv("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/PhenotypeData/Final_Phenotypes/Landrace_data.csv")
lrdta$X <- NULL
data <- subset(lrdta, lrdta$Region!="SWUS")
le1 <- as.data.frame(colnames(geno))
names(le1)[1] <- "names"
le2 <- as.data.frame(data$Row.names)
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)le1 <- as.data.frame(colnames(geno))
phenoorder <- merge(le1, data, by.x="names", by.y="Row.names",sort=FALSE)
View(phenoorder)
gs <- t ( as.matrix ( phenoorder$GS_bp, ncol = 1 ) )
gsgb <- gs/1000000000
alt <- t ( as.matrix ( phenoorder$Altitude , ncol = 1 ) )
alt <- alt - mean ( alt ) + 0.5
A <- as.matrix ( A )
source("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SelectionTests/jri_emma_fun.txt")
source("~/Documents/Projects/Genome_Size_Analysis/Github_ParallelGS/SelectionTests/jri_emma_returnbeta.txt")
out.gsgb <- emma.REML.t ( gsgb , alt , K = A )
out.gsgb <- emma.REML.t_beta ( gsgb , alt , K = A )
out.gsgb
out.gsgb
?emma.REML.t
?emma
emma.REML.t
?emma.REMLE
